/**
 * @license
 * Webix Diagram v.8.3.2
 * This software is can be used only as part of webix.com site
 * You are not allowed to copy this file and use in any other project
 */

 !function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var t=function n(t,e){return t(e={exports:{}},e.exports),e.exports}(function(t,d){Object.defineProperty(d,"__esModule",{value:!0});var e,n,i,c=function(){function o(t,e,n){this._tbounds=[0,0],t?(this.nodes=[e],t.collectSubNodes(e,this.nodes),this.hash=t.hash,this.root(e,n)):(this.nodes=[],this.hash={})}return o.prototype.copy=function(){var e=this,n=new o;return n.nodes=this.nodes.map(function(t){return{id:t.id,w:t.w,h:t.h,x:t.x,y:t.y,kids:[],links:[],isn:t.isn,iss:t.iss}}),n.hash={},n.nodes.forEach(function(t){n.hash[t.id]=t}),n.nodes.forEach(function(t){t.kids=e.hash[t.id].kids.map(function(t){return n.hash[t.id]}),t.links=e.hash[t.id].links.map(function(t){return n.hash[t.id]})}),n._tbounds=[].concat(this._tbounds),n._ybounds=[].concat(this._ybounds),n._bounds=this._bounds?this._bounds.map(function(t){return[].concat(t)}):[],n.routes=this.routes,n._root=this._root?n.hash[this._root.id]:null,n},o.prototype.collectSubNodes=function(t,e){for(var n=0;n<t.kids.length;n++){var i=t.kids[n];e.push(i),i.kids&&this.collectSubNodes(i,e)}},o.prototype.getLevelBounds=function(){return this._bounds},o.prototype.getBounds=function(t,e,n){var i;return[(i=n?this._tbounds:this._bounds[t])[0]?i[0]-e/2:0,i[1]?i[1]+e/2:0]},o.prototype.addEdge=function(t,e){var n=this.hash[t],i=this.hash[e];n.links.push(i),i.links.push(n)},o.prototype.importNodes=function(t){var e=this;t.forEach(function(t){e.hash[t.id]=t,e.nodes.push(t)})},o.prototype.split=function(e){var n=this,i=[];if(this.nodes=this.nodes.filter(function(t){return!e(t)||(delete n.hash[t.id],i.push(t),!1)}),!i.length)return null;var t=new o;return t.importNodes(i),t},o.prototype.addNode=function(t){t.kids=[],t.links=[],this._root||(this._root=t),this.hash[t.id]=t,this.nodes.push(t)},o.prototype.getNode=function(t){return this.hash[t]},o.prototype.getRoot=function(){return this._root},o.prototype.getLevels=function(){return this._deep},o.prototype.clean=function(){this.nodes.forEach(function(e){if(1<e.links.length){var n=[];e.links=e.links.filter(function(t){return-1===n.indexOf(t)&&e!==t&&(n.push(t),!0)})}})},o.prototype.getNodes=function(){return this.nodes},o.prototype.getBox=function(){return[this._tbounds,this._ybounds]},o.prototype.setGlobalBox=function(){var r,s,a,h;this.nodes.length&&(r=a=Infinity,s=h=-Infinity,this.nodes.forEach(function(t){var e=t.x-t.w/2,n=t.x+t.w/2,i=t.y-t.h/2,o=t.y+t.h/2;e<r&&(r=e),i<a&&(a=i),s<n&&(s=n),h<o&&(h=o)}),this._tbounds=[r,s],this._ybounds=[a,h])},o.prototype.translate=function(e){if(this.nodes.forEach(function(t){t.x+=e.x,t.y+=e.y}),this._tbounds[0]+=e.x,this._tbounds[1]+=e.x,this._bounds)for(var t=0;t<this._bounds.length;t++)this._bounds[t][0]+=e.x,this._bounds[t][1]+=e.x;this._ybounds&&(this._ybounds[0]+=e.y,this._ybounds[1]+=e.y)},o.prototype.rotate=function(t){var i=t.x,o=t.y;this.nodes.forEach(function(t){var e=t.x*o-t.y*i,n=t.x*i+t.y*o;t.x=e,t.y=n});var e=this._tbounds,n=e[0],r=e[1],s=this._ybounds,a=s[0],h=s[1];this._tbounds=[n*o-a*i,r*o-h*i].sort(),this._ybounds=[n*i+a*o,r*i+h*o].sort()},o.prototype.setBox=function(){var t=this._deep[this._deep.length-1],n=-Infinity;t.forEach(function(t){var e=t.y+t.h/2;n<e&&(n=e)}),this._ybounds=[this._root.y-this._root.h/2,n]},o.prototype.mirror=function(){this.nodes.forEach(function(t){t.x=-t.x});for(var t=0;t<this._bounds.length;t++){var e=this._bounds[t],n=e[0],i=e[1];this._bounds[t]=[-i,-n]}var o=this._tbounds,r=o[0],s=o[1];this._tbounds=[-s,-r]},o.prototype.nonLeaves=function(t){return t.kids.filter(function(t){return 0<t.kids.length})},o.prototype.toTree=function(t){return t&&this.hash[t.id]||(t=this._detectRoot()),this.nodes.forEach(function(t){return t.kids=[]}),this.setKids(t),t},o.prototype.root=function(t,e){
    this._deep=[[t]];var n=Math.round((e&&e.rotate?t.h:t.w)/2);this._tbounds=[-n,n],this._bounds=[[-n,n]],this._leaves=[],this._root=t,this._setLevels(t,1),this._width=1;for(var i=0;i<this._deep.length;i++){var o=this._deep[i].length;o>this._width&&(this._width=o)}},o.prototype.setKids=function(e){var n=this;e.links.forEach(function(t){t.kids.length||(e.kids.push(t),n.setKids(t))})},o.prototype._detectRoot=function(){for(var n={},t=this.nodes,i=[];i.forEach(function(t){return n[t]=1}),i=[],2<(t=t.filter(function(t){var e=1<t.links.map(function(t){return n[t.id]?0:1}).reduce(function(t,e){return t+e},0);return e||i.push(t.id),e})).length&&i.length;);return t[0]||this.nodes[0]},o.prototype._setLevels=function(t,e){for(var n=t.kids,i=0;i<n.length;i++){var o=n[i],r=this._deep[e];r?r.push(o):(this._deep[e]=[o],this._bounds[e]=[0,0]),o.kids.length?this._setLevels(o,e+1):this._leaves.push(o)}},o.prototype.getIString=function(){for(var t=[],e=0;e<this._leaves.length;e++)this._leaves[e].isn=0,this._leaves[e].iss="";for(e=this._deep.length-2;0<=e;e--){for(var n=this._deep[e].filter(function(t){return 0<t.kids.length}),i=0;i<n.length;i++)for(var o=n[i],r=0;r<o.kids.length;r++)o.iss=o.kids.map(function(t){return t.isn}).sort().join(",");n.sort(function(t,e){return t.iss>e.iss?1:-1}),t.push(n.map(function(t){return t.iss}).join("|"));var s=n[0].iss,a=1;for(i=0;i<n.length;i++)s!==n[i].iss&&(s=n[i].iss,a++),n[i].isn=a}return t.join(";")},o}();(n=d.LineMode||(d.LineMode={}))[n.Direct=1]="Direct",n[n.Edges=2]="Edges",n[n.Child=3]="Child",n[n.Sibling=4]="Sibling",(i=d.Direction||(d.Direction={}))[i.Top=1]="Top",i[i.Bottom=2]="Bottom",i[i.Right=3]="Right",i[i.Left=4]="Left";var o=((e={})[d.Direction.Bottom]={x:0,y:1},e[d.Direction.Top]={x:0,y:-1},e[d.Direction.Right]={x:1,y:0},e[d.Direction.Left]={x:-1,y:0},e),r=function(){function t(n,t){var i=this;this._config=n,this._conns=[],this._connMap=new Map,this._shapes=[],this._shapesMap=new Map,t&&(t.forEach(function(t){return i.addShape(t.id,t.x-t.w/2,t.y-t.h/2,t.x+t.w/2,t.y+t.h/2)}),t.forEach(function(e){e.links.forEach(function(t){return i.addConnector("",e.id,t.id,n.mode)})}))}return t.prototype.addShape=function(t,e,n,i,o){var r={cx:e+(i-e)/2,cy:n+(o-n)/2,x1:e,y1:n,x2:i,y2:o,id:t};this._shapesMap.set(t,r),this._shapes.push(r)},t.prototype.addConnector=function(t,e,n,i){var o={id:t,from:e,to:n,mode:i,line:[]};this._conns.push(o),this._connMap.set(t,o)},t.prototype.finalize=function(t){for(var e=0;e<this._conns.length;e++)this._conns[e].line.length||this.drawLine(this._conns[e],t);return this._conns},t.prototype.drawLine=function(t,e){var n=this._shapesMap.get(t.from),i=this._shapesMap.get(t.to),o=e===d.Direction.Top||e===d.Direction.Bottom,r=t.mode||this._config.mode,s=this._config.padding||8;switch(r){case d.LineMode.Direct:t.line=[[n.cx,n.cy],[i.cx,i.cy]];break;case d.LineMode.Edges:if(o?n.cy===i.cy:n.cx===i.cx)t.line=[[n.cx,n.cy],[i.cx,i.cy]];else if(o){var a=Math.floor((i.cy-n.cy)/2);t.line=[[n.cx,n.cy],[n.cx,n.cy+a],[i.cx,n.cy+a],[i.cx,i.cy]]}else{var h=Math.floor((i.cx-n.cx)/2);t.line=[[n.cx,n.cy],[n.cx+h,n.cy],[n.cx+h,i.cy],[i.cx,i.cy]]}break;case d.LineMode.Sibling:if(o){var l=Math.min(n.x1,i.x1)+s;t.line=[[n.cx+s,n.cy],[l,n.cy],[l,i.cy],[i.cx+s,i.cy]]}else t.line=[[n.cx,n.cy],[i.cx,i.cy]];break;case d.LineMode.Child:if(o){l=Math.min(n.x1,i.x1)+s;t.line=[[n.cx,n.cy],[l,n.cy],[l,i.cy],[i.cx+s,i.cy]]}else t.line=[[n.cx,n.cy],[i.cx,i.cy]]}},t}(),p=function(){function t(){}return t.prototype.layout=function(t,e){t.root(t.toTree(t.hash[e.root])),e.levelPadding=e.levelPadding||this._getStep(t.getNodes())+e.itemPadding,e.dir=e.dir||d.Direction.Bottom,e.rotate=e.dir===d.Direction.Right||e.dir===d.Direction.Left;var n=o[e.dir];this._layout(t,e),t.setBox(),e.dir!==d.Direction.Bottom&&t.rotate(n);var i=t.getBox();return t.translate({x:-1*i[0][0],y:-1*i[1][0]}),t.setBox(),t},t.prototype._layout=function(e,n){var i=this,t=e.getRoot();if(t.x=t.y=0,1==e.getLevels().length)return e._symmetry=!0,"0";var o=t.kids.map(function(t){return new c(e,t,n)}),h={};o.forEach(function(t){var e=i._layout(t,n)
    ;h[e]?h[e].push(t):h[e]=[t]});for(var r=Object.keys(h).sort(function(t,e){var n=h[t][0],i=h[e][0],o=n._width,r=i._width;if(r<o)return-1;if(o<r)return 1;var s=n.getLevels().length,a=i.getLevels().length;return a<s?-1:s<a?1:t<e?1:-1}),s=0,a=0,l=0;l<r.length;l++)h[r[l]].length%2==1&&(s++,a=l);var d=!1,u=!1;1==s?(h[r[a]][0]._symmetry&&(u=!0),d=!0,0!==a&&(r.unshift(r[a]),r.splice(a+1,1))):0===s&&(u=!0);return e._symmetry=u,this._layout_place(e,h,r,d,n),e.getIString()},t.prototype._layout_place=function(w,t,e,y,x){for(var m={x:0,y:x.levelPadding},_=!0,n=0;n<e.length;n++){t[e[n]].forEach(function(t){if(y){y=!1,t.translate(m);for(var e=0,n=0,i=t.getLevelBounds(),o=0;o<i.length;o++){var r=i[o],s=r[0],a=r[1];w._bounds[o+1]=[s,a],s<e&&(e=s),n<a&&(n=a)}w._tbounds=[e,n]}else{var h=_?1:0,l=_?0:1;_&&t.mirror();var d=void 0,u=void 0;u=d=999999*(_?-1:1);for(var c=x.itemPadding,p=0;p<t._bounds.length;p++){var g=w.getBounds(p+1,c,x.wide)[h]-t.getBounds(p,c,x.wide)[l];(_&&u<g||!_&&g<u)&&(u=g)}t.translate({x:u,y:m.y});for(var f=0;f<w._bounds.length;f++){var v=void 0;v=0==f||f>t._bounds.length?w._bounds[f][h]:w._bounds[f][h]=t._bounds[f-1][h],(_&&d<v||!_&&v<d)&&(d=v)}w._tbounds[h]=d,_=!_}})}},t.prototype._getStep=function(t){var e=0;return t.forEach(function(t){e=Math.max(e,t.w,t.h)}),e},t}(),s=function(){function t(){}return t.prototype.layout=function(t,e){var n=t.getRoot(),i={minSpaceBetweenGen:e.levelPadding||20,minSpaceBetweenSibling:e.itemPadding||5,minAngleBetweenSibling:-1},o=k(t,n,e,i,i.minSpaceBetweenGen,[],0,!0),r=o.subAngle,s=o.count,a=o.firstGenOffset,h=o.maxRadius,l=o.genOffset;i.minAngleBetweenSibling=_(i.minSpaceBetweenSibling,i.minSpaceBetweenGen+a);var d=i.minSpaceBetweenGen;360<r+s*i.minAngleBetweenSibling?d=g(r+i.minAngleBetweenSibling*s,h)/(2*Math.PI)-l.reduce(function(t,e){return t+e},0)-i.minSpaceBetweenGen*(l.length-1):i.minSpaceBetweenSibling=g((360-r)/s,o.maxRadius);var u=-d;return i.minAngleBetweenSibling=(360-k(t,n,e,i,d).subAngle)/s,function x(t,e,n,i,o,r,s,a,h){var l=e.kids;h&&(e.x=0,e.y=0);var d,u,c;var p,g=0;if(l.length){u=c=a;for(var f=0;f<l.length;f++)d=l[f],g=Math.max(g,M(d));g=g/2+M(e)/2;for(var f=0;f<l.length;f++){d=l[f];var v=h?0+g:i.minSpaceBetweenGen+g;c=x(t,d,n,i,o+v,r-v,s-v,c,!1)}if(!h){var w=(u+c)/2;p=m(w,o,r,s),e.x=p.x,e.y=p.y}}else{var y=b(M(e),o),w=_(y,o)+i.minAngleBetweenSibling;p=m(a+w/2,o,r,s),e.x=p.x,e.y=p.y,c=a+w}return c}(t,n,e,i,d,u,u,0,!0),t.translate({x:1e3,y:1e3}),t},t}();function m(t,e,n,i){var o,r={x:n+e,y:i};if(0===t)o=r;else{var s=t,a=s<=180;a||(s=360-s);var h=(180-s)/2,l=90-h,d=2*e*Math.sin(Math.PI*s/180/2),u=d*Math.sin(Math.PI*l/180),c=d*Math.sin(Math.PI*h/180);o={x:r.x+(a?c:-c),y:r.y+u}}return o}function _(t,e){return Math.ceil(t/e*180/Math.PI)}function k(t,e,n,i,o,r,s,a){r||(r=[]);var h=e.kids,l=0,d=0,u=0;if(h.length){for(var c=void 0,p=0,g=0;g<h.length;g++)c=h[g],p=Math.max(p,M(c));p=p/2+M(e)/2;for(g=0;g<h.length;g++){var f=k(t,c=h[g],n,i,a?o+p:o+i.minSpaceBetweenGen+p,r,s?s+1:1,!1),v=f.subAngle,w=f.count,y=f.maxRadius;l+=v,d+=w,u=Math.max(u,y)}return r[s-1]||r.push(p),{subAngle:l,count:d,maxRadius:u,firstGenOffset:p,genOffset:r}}return{subAngle:_(b(M(e),o),o),count:1,maxRadius:o}}function b(t,e){return 2*e*Math.asin(t/(2*e))}function g(t,e){return e*Math.PI*t/180}function M(t){var e=t.w,n=t.h;return Math.ceil(Math.sqrt(e*e+n*n))}var a=[1,2,4,8,0,16,32,64,128],l=function(){function t(){this._map={}}return t.prototype.getRoute=function(t,e){var n=this._map[t];return n&&n.map[e]||null},t.prototype.addRoute=function(t,e,n,i){this.addPath(t,e,n,i),this.addPath(e,t,-n,-i)},t.prototype.hasRoute=function(t,e,n){var i=this._map[t];return!!i&&0<(i.dir&this._code(e,n))},t.prototype.isAligned=function(t){return!!this._map[t]},t.prototype.isAxisAligned=function(t,e,n){var i=this._map[t];if(!i)return null;for(var o in i.map){var r=i.map[o];if(e&&r.dy||n&&r.dx)return!1}return!0},t.prototype.addPath=function(t,e,n,i,o){var r=this._map[t];r||(r=this._map[t]={map:{},dir:0}),r.map[e]={dx:n,dy:i,points:o},r.dir=r.dir|this._code(n,i)},t.prototype._code=function(t,e){return a[Math.sign(t)+1+3*(
    Math.sign(e)+1)]},t}();function u(t,e){var n=new c;return n.importNodes(t),{g:n,root:e}}var h=function(){function t(){}return t.prototype.layout=function(t,e){if(t.routes=new l,!e.full){var n=f(t,e);return e.preserveLocation||w(n.n,n.size),x(n.mx,n.n,n.n,n.size),t.setGlobalBox(),t}var i=function h(n){var t=n.getNodes();if(t.length<3)return[{g:n}];for(var e=t[0],i=[],o=t.length+1;o!=t.length;)o=t.length,t=t.filter(function(e){if(1!=e.links.length)return!0;var t=n.hash[e.links[0].id];return t&&(t.links=t.links.filter(function(t){return t.id!=e.id})),i.push(e),!1});if(t.length<2)return i.filter(function(t){return 0<t.links.length}).forEach(function(t){t.links[0].links.push(t)}),n.root(n.toTree(e)),[{g:n}];var r={};i.forEach(function(t){return r[t.id]=t});var s=i.filter(function(t){return!r[t.links[0].id]}).map(function(t){return[t]});i.forEach(function(t){var e=r[t.links[0].id];e&&e.links.push(t)});var a=s.map(function(t){for(var e,n=0;e=t[n++];){var i=e.links.length;if(1<i)for(var o=1;o<i;o++){var r=e.links[o];t.push(r)}}return u(t,t[0].links.splice(0,1)[0].id)});return[u(t,null)].concat(a)}(t);if(1==i.length&&null!==i[0].root)return(new p).layout(i[0].g,e);(t=i[0].g).routes=new l;var o=f(t,e);return e.preserveLocation||w(o.n,o.size),x(o.mx,o.n,o.n,o.size),e.full&&(!function r(p,t,e,g){e.length,e.forEach(function(t){return t.iss=""});var n=[].concat(e).filter(function(t){return 3<=t.links.length}).sort(function(t,e){return t.links.length>e.links.length?-1:t.links.length==e.links.length?0:1});if(n.map(function(o){var r=[];return o.links.forEach(function(t){var e=Math.atan2(t.x-o.x,t.y-o.y)+Math.PI,n=2*Math.ceil(e/(2*L))*L,i=2*Math.floor(e/(2*L))*L;r.push([t,n,Math.abs(e-n)]),r.push([t,i,Math.abs(e-i)])}),r.sort(function(t,e){return t[2]>e[2]?1:-1}),[o,r]}).forEach(function(t){var e=t[0],n=t[1],i=e.x,o=e.y;e.x=Math.round(e.x/g)*g,e.y=Math.round(e.y/g)*g;for(var r=0;r<n.length;r++){var s=n[r],a=s[0];if(!p.getRoute(e.id,a.id)){var h=S(e,a,s[1],g,i,o),l=h[0],d=h[1],u=h[2],c=h[3];p.hasRoute(e.id,u,c)||p.isAligned(a.id)||(a.x+=l,a.y+=d,p.addRoute(e.id,a.id,u,c))}}}),x(t,e,e.filter(function(t){return!p.isAligned(t.id)}),g),n.forEach(function(e){p.isAligned(e.id)||(e.x=Math.round(e.x/g)*g,e.y=Math.round(e.y/g)*g),e.links.forEach(function(t){2==t.links.length&&C(e,t,p,g)})}),0===n.length){var i=e[0],o=e[0].links[0];o.x=Math.round(o.x/g)*g,o.y=Math.round(o.y/g)*g,C(i,o,p,g)}}(t.routes,o.mx,o.n,o.size),t=function s(a,h,t,l,d){var u=a.getNodes().length;return t.forEach(function(t){var e=t.g,n=t.root,i={root:e.getNodes()[0].id,itemPadding:l.itemPadding,levelPadding:l.levelPadding};(new p).layout(e,i);var o=function s(c,t,p,g,v,y,x){return t.map(function(t){if(!t[2]&&!t[3]&&p.routes.hasRoute(v,t[0],t[1]))return null;var e=g.copy(),n=p.copy(),i=e.getRoot(),o=n.hash[v];e.rotate({x:-t[0],y:t[1]});var r=e.getBox(),s=r[0][1]-r[0][0],a=r[1][1]-r[1][0],h=i.x-r[0][0]-s/2,l=i.y-r[1][0]-a/2;!function w(t,e,n,i,o,r,s,a){var h,l,d,u,c,p,g=e.x+(a[2]||a[0])*s,f=e.y+(a[3]||a[1])*s;if(E(t,g-s/2,g+s/2,f-s/2,f+s/2))j(t,g-s/2*a[0],f-s/2*a[1],n,i,a,s);else if(!((a[0]?n:i)/s-1<=0)){var v=.45*s;(p=a[0]?(d=g+s/2*a[0],u=d+n*a[0],(c=f-i/2-v-r)+i+2*v):(u=(d=g-n/2-v-o)+n+2*v,(c=f+s/2*a[1])+i*a[1]))<c&&(c=(h=[p,c])[0],p=h[1]),u<d&&(d=(l=[u,d])[0],u=l[1]),E(t,d,u,c,p)&&j(t,g,f,n,i,a,s)}}(n,o,s,a,h,l,y,t),function u(t,e,n,i,o,r){var s=n.x+o*(r[0]||r[2])-i.x,a=n.y+o*(r[1]||r[3])-i.y;e.translate({x:s,y:a}),t.importNodes(e.getNodes())}(n,e,o,i,y,t);var d=function f(t,e){for(var n,i=e.length,o=0,r=0;r<i;r++){n=0;for(var s=e[r],a=t[s.isn],h=0;h<i;h++)if(s.isn!=h){var l=e[h],d=a[l.isn],u=.5/(d*d),c=s.x-l.x,p=s.y-l.y,g=Math.sqrt(Math.pow(c,2)+Math.pow(p,2));g&&(n+=u*(c-d*c/g),n+=u*(p-d*p/g))}o+=Math.sqrt(Math.pow(n,2)+Math.pow(0,2))}return o}(c,n.getNodes().slice(0,x));return{g:n,s:d,dir:t}}).reduce(function(t,e){return!t||e&&e.s<t.s?e:t})}(h,H,a,e,n,d,u);if(o){a=o.g;var r=e.getRoot().id;return o.dir[2]||o.dir[3]||a.routes.addRoute(n,e.getRoot().id,o.dir[0],o.dir[1]),a.hash[n].links.push(a.hash[r]),void a.hash[r].links.push(a.hash[n])}console.log("Can't position sub tree")}
    ),a}(t,o.mx,i.slice(1).sort(V),e,o.size)),t.setGlobalBox(),t},t}();function f(t,e){var n=t.getNodes(),i=0,o=0;return n.forEach(function(t,e){t.isn=e,i=Math.max(i,t.w,t.h),o+=t.w+t.h}),e.itemPadding=e.itemPadding||Math.round(o/(2*n.length)),i+=e.itemPadding,{n:n,mx:function r(t){for(var e=[],n=t.getNodes(),i=0;i<n.length;i++){var o=e[i]=[];o[n[i].isn]=0,v(n[i],o,i,1)}return e}(t),size:i}}function v(t,e,n,i){for(var o=[t],r=[];o.length;){for(var s=0;s<o.length;s++)for(var a=o[s],h=0;h<a.links.length;h++){var l=a.links[h],d=l.isn;d==n||e[d]||(e[d]=i,r.push(l))}i++,o=r,r=[]}}function w(t,e){var n=2*Math.PI/t.length,i=0,o=5*e;t.forEach(function(t,e){t.x=Math.round(Math.cos(i)*o),t.y=Math.round(Math.sin(i)*o),i+=n})}function y(t,e,n,i){for(var o,r,s=0,a=0,h=0,l=0,d=e.length,u=n.length,c=0;c<u;c++){r=o=0;for(var p=n[c],g=t[p.isn],f=0;f<d;f++)if(p.isn!=f){var v=.5/((S=g[(C=e[f]).isn])*S),w=p.x-C.x,y=p.y-C.y;(B=Math.sqrt(Math.pow(w,2)+Math.pow(y,2)))&&(o+=v*(w-i*S*w/B),r+=v*(y-i*S*y/B))}var x=Math.sqrt(Math.pow(o,2)+Math.pow(r,2));a<x&&(s=p.isn,a=x,h=o,l=r)}var m,_=0,k=0,b=0,M=e[s],L=t[s];for(f=0;f<d;f++)if(s!=f){v=.5/((S=L[(C=e[f]).isn])*S);var C,S,B,H=(w=M.x-C.x)*w,j=(y=M.y-C.y)*y;(B=Math.sqrt(Math.pow(H+j,3)))&&(_+=v*(1-i*S*j/B),k+=v*i*S*y*w/B,b+=v*(1-i*S*H/B))}return[s,a,m=(-h/_+k*l/(b*_))/(1+k*k/(b*_)),(-l-k*m)/b]}function x(t,e,n,i){for(var o=0;o++<100;){var r=y(t,e,n,i),s=r[0],a=r[1],h=r[2],l=r[3];if(a<10)break;e[s].x+=h,e[s].y+=l}}var L=Math.PI/4;function C(t,e,n,i){for(;;){var o=e.links[0];if(o==t&&(o=e.links[1]),t=e,2<(e=o).links.length)break;for(var r=Math.atan2(e.x-t.x,e.y-t.y)+Math.PI,s=2*Math.ceil(r/(2*L))*L,a=2*Math.floor(r/(2*L))*L,h=Math.abs(r-s)<Math.abs(r-a)?[s,a]:[a,s],l=0;l<h.length;l++){var d=S(t,e,h[l],i,t.x,t.y),u=d[0],c=d[1],p=d[2],g=d[3];if(!n.hasRoute(t.id,p,g)){if(n.isAligned(e.id))return;e.x+=u,e.y+=c,n.addRoute(t.id,e.id,p,g);break}}}}function S(t,e,n,i,o,r){return n<=L||7*L<n?[t.x-e.x,B(t.y,e.y,r,i),0,-1]:n<=3*L&&L<n?[B(t.x,e.x,o,i),t.y-e.y,-1,0]:n<=5*L&&3*L<n?[t.x-e.x,B(t.y,e.y,r,i),0,1]:[B(t.x,e.x,o,i),t.y-e.y,1,0]}function B(t,e,n,i){var o=Math.sign(n-e);return t-e-(Math.round((n-e)/i)||o)*i}var H=[[0,1,0,0],[1,0,0,0],[-1,0,0,0],[0,-1,0,0]].concat([[0,1,-1,1],[-1,0,-1,1],[0,1,1,1],[1,0,1,1],[1,0,1,-1],[0,-1,1,-1],[-1,0,-1,-1],[0,-1,-1,-1]]);function j(t,e,n,i,o,r,s){t.getNodes().forEach(function(t){r[1]?Math.sign(t.y-n)==r[1]&&(t.y+=(o+s/2)*r[1]):r[0]&&Math.sign(t.x-e)==r[0]&&(t.x+=(i+s/2)*r[0])})}function E(t,e,n,i,o){for(var r=t.getNodes(),s=0;s<r.length;s++){var a=r[s];if(a.x>=e&&a.x<=n&&a.y>=i&&a.y<=o)return!0}return!1}function V(t,e){var n=t.g.getNodes().length,i=e.g.getNodes().length;return i<n?-1:n===i?0:1}d.Graph=c,d.Hola=h,d.RadialTree=s,d.Router=r,d.SymmetricTree=p,d.compose=function Z(t,i){if(t.length<2)return t[0]||null;var o=t[0].getBox(),r=i.padding,e=t.reduce(function(t,e){var n=e.getBox();return e.translate({x:o[0][1]-n[0][0]+r,y:o[1][0]-n[1][0]}),t.importNodes(e.getNodes()),r+=i.padding+n[0][1]-n[0][0],t});return t.length&&e.setGlobalBox(),e},d.decompose=function T(o){for(var r=[],t=function(){var e={},t=o.getNodes();if(!t.length)return{value:r};!function i(t,e){e[t.id]=1,t.links.forEach(function(t){e[t.id]||i(t,e)})}(t[0],e);var n=o.split(function(t){return!e[t.id]});if(r.push(o),!n)return{value:r};o=n};;){var e=t();if("object"==typeof e)return e.value}}}),a=function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:t}(t),o=(t.LineMode,t.Direction,t.Graph,t.Hola,t.RadialTree,t.Router,t.SymmetricTree,t.compose,t.decompose,{action:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t<path fill-rule="evenodd" clip-rule="evenodd" d="M79.75 1H12.25C6.0175 1 1 9.92 1 21C1 32.08 6.0175 41 12.25 41H79.75C85.9825 41 91 32.08 91 21C91 9.92 85.9825 1 79.75 1Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',
    arrow:'<svg width="86" height="8" viewBox="0 0 86 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M85.3536 4.35355C85.5488 4.15829 85.5488 3.84171 85.3536 3.64645L82.1716 0.464466C81.9763 0.269204 81.6597 0.269204 81.4645 0.464466C81.2692 0.659728 81.2692 0.976311 81.4645 1.17157L84.2929 4L81.4645 6.82843C81.2692 7.02369 81.2692 7.34027 81.4645 7.53553C81.6597 7.7308 81.9763 7.7308 82.1716 7.53553L85.3536 4.35355ZM0 4.5H85V3.5H0V4.5Z" fill="#CCD7E6"/>\n</svg>\n',circle:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M21 41C32.0457 41 41 32.0457 41 21C41 9.9543 32.0457 1 21 1C9.9543 1 1 9.9543 1 21C1 32.0457 9.9543 41 21 41Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',collate:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 1L21 21L41 1H1Z"   stroke-linecap="round" stroke-linejoin="round"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M41 41L21 21L1 41H41Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',connector:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 1H21L41 21L21 41H1V1Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',data:'<svg width="100%" height="100%" viewBox="0 0 90 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8.022 39.0474C4.64748 39.0474 0.978516 30.8836 0.978516 19.9998C0.978516 9.11596 4.64748 0.952148 8.022 0.952148H81.9786C78.4569 0.952148 74.9351 9.11596 74.9351 19.9998C74.9351 30.8836 78.4569 39.0474 81.9786 39.0474H8.022Z"  stroke-linecap="round" stroke-linejoin="round"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M81.979 39.0474C78.4573 39.0474 74.9355 30.8836 74.9355 19.9998C74.9355 9.11596 78.4573 0.952148 81.979 0.952148C85.5008 0.952148 89.0225 9.11596 89.0225 19.9998C89.0225 30.8836 85.5008 39.0474 81.979 39.0474Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',database:'<svg width="100%" height="100%" viewBox="0 0 72 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 6C1 8.5 16.4 11 36 11C55.6 11 71 8.5 71 6V36C71 38.5 55.6 41 36 41C16.4 41 1 38.5 1 36V6Z"   stroke-linecap="round" stroke-linejoin="round"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M71 6C71 8.5 55.6 11 36 11C16.4 11 1 8.5 1 6C1 3.5 16.4 1 36 1C55.6 1 71 3.5 71 6Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',decision:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M21 1L1 21L21 41L41 21L21 1Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',display:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M19 41L1 21L19 1H70.0005C82 1 91 9.572 91 21C91 32.428 82 41 70.0005 41H19Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',document:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 1H91V37.7199C46 22.7124 46 53.1524 1 35.0587V1Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',dot:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M21 41C32.0457 41 41 32.0457 41 21C41 9.9543 32.0457 1 21 1C9.9543 1 1 9.9543 1 21C1 32.0457 9.9543 41 21 41Z"  stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M21 33C27.6274 33 33 27.6274 33 21C33 14.3726 27.6274 9 21 9C14.3726 9 9 14.3726 9 21C9 27.6274 14.3726 33 21 33Z" class="webix_diagram_shape_alt"/>\n</svg>\n',
    join:'<svg width="100%" height="100%" viewBox="0 0 75 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M71 0H4C1.79086 0 0 1.79086 0 4C0 6.20914 1.79086 8 4 8H71C73.2091 8 75 6.20914 75 4C75 1.79086 73.2091 0 71 0Z"/>\n</svg>\n',junction:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M21 41C32.0457 41 41 32.0457 41 21C41 9.9543 32.0457 1 21 1C9.9543 1 1 9.9543 1 21C1 32.0457 9.9543 41 21 41Z"   stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M7 7L35 35"  stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M35 7L7 35"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',head:'<svg width="100%" height="100%" viewBox="0 0 40 53" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M1.00742 1.26718L39.0947 26.5L1.00742 51.7328L10.3731 26.6751L10.4385 26.5L10.3731 26.3249L1.00742 1.26718Z" />\n</svg>\n',heptagon:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M12.0992 41H29.9009L41 26.7242L37.0388 8.92249L21 1L4.96124 8.92249L1 26.7242L12.0992 41Z"  />\n</svg>\n',input:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 15.1178L91 1V41H1V15.1178Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',internal:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 1H91V41H1V1Z"   stroke-linecap="round" stroke-linejoin="round"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13 1V41V1Z" />\n<path d="M13 1V41"  stroke-linecap="round" stroke-linejoin="round"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 11.6665H91H1Z" />\n<path d="M1 11.6665H91"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',line:'<svg width="86" height="5" viewBox="0 0 86 5" fill="none" xmlns="http://www.w3.org/2000/svg">\n<line x1="-4.37114e-08" y1="2.5" x2="81.8276" y2="2.49999" />\n<circle cx="82.8789" cy="2.5" r="2.5" transform="rotate(-90 82.8789 2.5)" fill="#CCD7E6"/>\n</svg>\n',looplimit:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M0.999998 11.6667L13 1L79 1.00001L91 11.6667L91 41L0.999993 41L0.999998 11.6667Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',multidoc:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M4.10352 1H91.0001V33.6129C47.5518 20.2848 47.5518 47.3191 4.10352 31.2497V1Z"   stroke-linecap="round" stroke-linejoin="round"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2.55078 3.23682H89.4473V35.8498C45.9991 22.5216 45.9991 49.5559 2.55078 33.4865V3.23682Z"   stroke-linecap="round" stroke-linejoin="round"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 5.47363H87.8966V38.0866C44.4483 24.7584 44.4483 51.7927 1 35.7234V5.47363Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',note:'<svg width="100%" height="100%" viewBox="0 0 32 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M31 14.8096L20.6428 1H2.5C1.669 1 1 1.76468 1 2.71403V39.286C1 40.2353 1.669 41 2.5 41H29.5C30.331 41 31 40.2353 31 39.286V14.8096Z"  stroke-linecap="round" stroke-linejoin="round"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M20.6426 1L30.9998 14.8096H22.1426C21.3116 14.8096 20.6426 14.0449 20.6426 13.0955V1Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',octagon:'<svg width="100%" height="100%" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M39.5 28.0772L28.0767 39.5H11.9233L0.5 28.0767V11.9228L11.9228 0.5H28.0772L39.5 11.9228V28.0772Z"  />\n</svg>\n',
    operation:'<svg width="100%" height="100%" viewBox="0 0 82 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 1L11.6667 41H70.3333L81 1H1Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',or:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M21 41C32.0457 41 41 32.0457 41 21C41 9.9543 32.0457 1 21 1C9.9543 1 1 9.9543 1 21C1 32.0457 9.9543 41 21 41Z"   stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M21 1V41"  stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M41 21H1"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',output:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 41L13 1H91L79 41H1Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',pentagon:'<svg width="100%" height="100%" viewBox="0 0 40 39" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M19.7971 0.568597L19.7975 0.568277C19.9158 0.477665 20.0806 0.476569 20.2022 0.569023C20.2022 0.569054 20.2023 0.569086 20.2023 0.569118L39.3666 15.2091C39.3669 15.2093 39.3672 15.2095 39.3674 15.2097C39.4804 15.2971 39.5272 15.4458 39.4842 15.5829C39.4839 15.5836 39.4837 15.5843 39.4835 15.585L32.1637 37.6042C32.1187 37.7394 31.9903 37.8322 31.8465 37.8322H8.15531C8.00942 37.8322 7.88332 37.7406 7.83824 37.6048L7.83816 37.6045L0.516771 15.5803C0.516738 15.5802 0.51669 15.5801 0.516658 15.58C0.472654 15.4468 0.517787 15.2972 0.63151 15.2094C0.631684 15.2093 0.631858 15.2091 0.632032 15.209L19.7971 0.568597Z"  />\n</svg>\n',plus:'<svg width="100%" height="100%" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M21.9956 17.5044V18.0044H22.4956H39.5V21.9956H22.4956H21.9956V22.4956V39.5H18.0044V22.4956V21.9956H17.5044H0.5V18.0044H17.5044H18.0044V17.5044V0.5H21.9956V17.5044Z"  />\n</svg>\n',preparation:'<svg width="100%" height="100%" viewBox="0 0 62 32" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M9 31L1 16L9 1H53L61 16L53 31H9Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',process:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 1H91V41H1V1Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',rtriangle:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 41L41.5 41L0.999998 1L1 41Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',sort:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M21 1L1 21L21 41L41 21L21 1Z"   stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M1 21H41"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',star:'<svg width="100%" height="100%" viewBox="0 0 40 37" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M20 1.61804L24.0148 13.9742L24.127 14.3197H24.4903H37.4823L26.9715 21.9562L26.6776 22.1697L26.7899 22.5152L30.8046 34.8713L20.2939 27.2348L20 27.0213L19.7061 27.2348L9.19535 34.8713L13.2101 22.5152L13.3224 22.1697L13.0285 21.9562L2.51771 14.3197H15.5097H15.873L15.9852 13.9742L20 1.61804Z"  />\n</svg>\n',start:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M79.75 1H12.25C6.0175 1 1 9.92 1 21C1 32.08 6.0175 41 12.25 41H79.75C85.9825 41 91 32.08 91 21C91 9.92 85.9825 1 79.75 1Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',
    storage:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M23.8 41C11.8 41 1 32.428 1 21C1 9.572 11.8 1 23.8 1H91C77 14.3333 77 27.6667 91 41H23.8Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',subroutine:'<svg width="100%" height="100%" viewBox="0 0 92 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1 1H91V41H1V1Z"  stroke-linecap="round" stroke-linejoin="round"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13 1V41V1ZM79 1V41V1Z" fill="#EBEDF0"/>\n<path d="M79 1V41M13 1V41V1Z"  stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',tail:'<svg width="100%" height="100%" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M26.1987 39.5L0.923247 39.5L13.6518 19.9915L13.8326 19.7144L13.6483 19.4397L0.937714 0.499998L26.2029 0.5L39.3963 19.7223L26.1987 39.5Z" />\n</svg>\n',trapezoid:'<svg width="100%" height="100%" viewBox="0 0 82 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M81 41L70.3333 0.999999L11.6667 0.999994L1 41L81 41Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',triangle:'<svg width="100%" height="100%" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M41 41L21 0.999998L1 41L41 41Z"   stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'}),h={fontColor:function(t){return"color:".concat(t,";")},fontSize:function(t){return"font-size:".concat(t,";")},fontWeight:function(t){return"font-weight:".concat(t,";")},fontStyle:function(t){return"font-style:".concat(t,";")},textAlign:function(t){var e="center";return"left"==t?e="flex-start":"right"==t&&(e="flex-end"),"justify-content:".concat(e,";")},textVAlign:function(t){var e="center";return"top"==t?e="flex-start":"bottom"==t&&(e="flex-end"),"align-items:".concat(e,";")},angle:function(t){return"transform:rotate(".concat(t,"deg);transform-origin:50% 50%;")},fillOpacity:function(t){return"fill-opacity:".concat(t,";")},lineWidth:function(t){return"stroke-width:".concat(t,";")},lineColor:function(t){return"stroke:".concat(t,";")},lineStyle:function(t){var e=t;return"dotted"==t?e="2,2":"dashed"==t?e="4,4":webix.isArray(t)&&(e=t.join(",")),"stroke-dasharray:".concat(e,";")},backgroundColor:function(t){return"fill:".concat(t,";")},altBackgroundColor:function(t){return"fill:".concat(t,";")}},l={text:["fontColor","fontSize","fontWeight","fontStyle","textAlign","textVAlign"],svg:["angle","fillOpacity","lineWidth","lineColor","lineStyle","backgroundColor"],alt:["altBackgroundColor"],line:["lineWidth","lineColor","lineStyle"],arrow:["fillOpacity","lineWidth","lineColor","backgroundColor"]};function i(t,e,n){var i=l[e]||[];n=n||{};for(var o="",r=0;r<i.length;r++){var s=t[i[r]]||n[i[r]];webix.isUndefined(s)||(o+=h[i[r]](s))}return o}webix.protoUI({name:"diagram",defaults:{scroll:"auto",autoplace:!0,treePadding:120,padding:20},$init:function(t){var e=this;this._html=document.createElement("DIV"),this.$view.className+=" webix_diagram",this._destroy_with_me=[],this.data.provideApi(this,!0),this._initLinks(t.links),this._initShapes(t.shapes),t.scheme=this._setScheme(t.scheme),this._dataobj=this.$view.querySelector(".webix_scroll_cont"),this._dataobj.innerHTML='\n\t\t\t<div class="webix_diagram_shapes" style="position:absolute;"></div>\n\t\t\t<svg width="100%" height="100%" style="overflow:visible"></svg>',this._links_layer=this._dataobj.querySelector("svg"),this._shapes_layer=this._dataobj.querySelector(".webix_diagram_shapes"),this.$blockRender=!0,webix.promise.all([this.data.waitData,this._links.waitData]).then(function(){e.$blockRender=!1,e.data.callEvent("onStoreUpdated",[])}),this.data.attachEvent("onStoreUpdated",function(){return e.render()}),this.types||(this.types={"default":this.type},this.type.name="default"),this.type=webix.clone(this.type),this.linkType=webix.clone(this.linkType),this.$ready.push(this._afterInit)},
    _id:"webix_dg_id",on_click:{webix_diagram_item:function(t){if(this.config.select){var e=this.locate(t);"multiselect"==this.config.select||this.config.multiselect?this.select(e,!1,t.ctrlKey||t.metaKey||"touch"==this.config.multiselect,t.shiftKey):this.select(e)}}},on_context:{},on_dblclick:{},_line_modes:{direct:1,edges:2,child:3,sibling:4},_exportScheme:function(t){return delete(t=webix.copy(t)).$list,t},_afterInit:function(){var t=this.config;this._dataobj.style.position="relative",this._dataobj.style.margin="".concat(t.paddingY||t.padding,"px ").concat(t.paddingX||t.padding,"px"),this.attachEvent("onDestruct",function(){this._dataobj=this._html=this._htmlmap=this._links_layer=this._shapes_layer=null,this._shapes=this._links=null;for(var t=0;t<this._destroy_with_me.length;t++)this._destroy_with_me[t].destructor()})},getItemNode:function(t){if(this._htmlmap)return this._htmlmap[t];this._htmlmap={};for(var e=this._shapes_layer.childNodes,n=0;n<e.length;n++){var i=e[n].getAttribute(this._id);i&&(this._htmlmap[i]=e[n])}return this.getItemNode(t)},locate:function(t){return webix.html.locate(t,this._id)},_toHTMLObject:function(t){return this._html.innerHTML=this._toHTMLItem(t),this._html.firstChild},$getSize:function(t,e){var n=this.config;return n.autowidth&&(t=this._dataobj.offsetWidth+(n.paddingX||n.padding)+(this._dataobj.offsetHeight>e&&!n.autoheight?webix.env.scrollSize:0)),n.autoheight&&(e=this._dataobj.offsetHeight+2*(n.paddingY||n.padding)+(this._dataobj.offsetWidth>t&&!n.autowidth?webix.env.scrollSize:0)),webix.ui.baseview.prototype.$getSize.call(this,t,e)},$setSize:function(t,e){webix.ui.baseview.prototype.$setSize.call(this,t,e)&&this.render()},_set_dataobj_size:function(t){this._dataobj.style.width=t[0][1]+(this.config.paddingX||this.config.padding)+"px",this._dataobj.style.height=t[1][1]+"px"},linkItem_setter:function(t){this.linkType_setter(t)},linkType_setter:function(t){if(t&&"object"==r(t))for(var e in t)0===e.indexOf("template")?this.linkType[e]=webix.template(t[e]):this.linkType[e]=t[e]},linkType:{css:"",mode:"edges",arrow:!1,arrowCss:"",arrowSize:6,getStyle:function(t,e){return i(t,e)},templateLine:function(t){if(!t.line||!t.line.length)return"";var e=t.line.map(function(t){return webix.isArray(t)?[Math.ceil(t[0]),Math.ceil(t[1])].join(","):t}).join(" "),n=t.type||"polyline";return"<".concat(n,' points="').concat(e,'" ').concat(t.css?'class="'.concat(t.css,'" '):""," ").concat(t.style?'style="'.concat(t.style,'"'):"","/>")},templateLink:function(t,e,n){webix.isArray(t.line)&&(n=t.line);var i={line:n,css:"webix_diagram_link ".concat(t.$css||this.linkType.css),style:e.getStyle.call(this,t,"line",e)};return e.templateLine.call(this,i,e)},templateArrow:function(t,e,n){webix.isArray(t.arrow)&&(n=t.arrow);var i={line:n,css:"webix_diagram_arrow ".concat(t.$arrowCss||this.linkType.arrowCss),style:e.getStyle.call(this,t,"arrow",e)};return"triangle"==(webix.isUndefined(t.arrow)?this.linkType.arrow:t.arrow)&&(i.type="polygon"),e.templateLine.call(this,i,e)}},autoPlace:function(t){this.config.autoplace||this._renderGraph(!0,t)},template_setter:function(t){this.type.template=webix.template(t)},customize:function(t){webix.type(this,t)},item_setter:function(t){return this.type_setter(t)},type_setter:function(t){return this.types[t]?(this.type=webix.clone(this.types[t]),this.type.css&&(this.$view.className+=" "+this.type.css)):this.customize(t),this.type.on_click&&webix.extend(this.on_click,this.type.on_click),t},type:{width:80,height:30,margin:20,marginX:0,marginY:0,listMarginX:20,classname:function(t,e){var n="webix_diagram_item";t.$css&&("object"==r(t.$css)&&(t.$css=webix.html.createCss(t.$css)),n+=" "+t.$css);var i=t.type||e.type;i?this.getShape(i)?n+=" webix_diagram_item_shape  webix_diagram_item_shape_"+i:n+=" webix_diagram_item_"+i:n+=" webix_diagram_item_def",e.css&&("function"==typeof e.css?n+=" "+e.css.call(this,t,e):n+=" "+e.css);var o=this.data.getMark(t.id,"$css");return o&&(n+=o),n},getStyle:function(t,e,n){return i(t,e,this.getShape(t.type||n.type))},template:webix.template("#value#"),templateSvg:function(
    t,e){var n,i=this.getShape(t.type||e.type),o="";return i&&(o=i.svg,(n=e.getStyle.call(this,t,"svg",e))&&(o=o.replace(/(<svg)/i,"$1 style='"+n+"'")),(n=e.getStyle.call(this,t,"alt",e))&&(o=o.replace(/(class="webix_diagram_shape_alt")/gi,"$1 style='"+n+"'"))),o},templateTextStart:function(t,e){return"<div class='webix_diagram_text' style='"+e.getStyle.call(this,t,"text",e)+"'><span class='webix_diagram_text_inner'>"},templateStart:function(t,e){var n=this.getShape(t.type||e.type)||{},i=t.$list?e.listMarginX:0,o="width:".concat(1*t.width||n.width||e.width-i,"px;height:").concat(1*t.height||n.height||e.height,"px;");return o+="top:".concat(1*t.y,"px;left:").concat(1*t.x+i,"px;"),'<div webix_dg_id="'+t.id+'" class="'+e.classname.call(this,t,e)+'" style="'+o+'">'+e.templateSvg.call(this,t,e)+e.templateTextStart.call(this,t,e)},templateTextEnd:webix.template("</span></div>"),templateEnd:webix.template("{common.templateTextEnd()}</div>")},_initLinks:function(t){var e=this;t&&t.getItem?this._links=t:(this._links=new webix.DataCollection,this._destroy_with_me.push(this._links),t&&"string"==typeof t?this._links.load(t,this.config.datatype):this._links.parse(t||[],this.config.datatype)),this._links.data.attachEvent("onStoreUpdated",function(){return e.render()})},getLinks:function(){return this._links},_toHTMLItem:function(t){return this.callEvent("onItemRender",[t]),this.type.templateStart.call(this,t,this.type)+this.type.template.call(this,t,this.type)+this.type.templateEnd.call(this,t,this.type)},render:function(t,e,n){if(this.isVisible(this.config.id)&&!this.$blockRender){if("update"!=n)return this._renderGraph(),!0;var i=this.getItemNode(t),o=this._htmlmap[t]=this._toHTMLObject(e);return webix.html.insertBefore(o,i),webix.html.remove(i),!0}},_renderGraph:function(t,e){var n={full:!0,root:e||this.config.root,preserveLocation:!t&&!this.config.autoplace,itemPadding:this.type.marginX||this.type.margin};if(this.callEvent("onBeforeRender",[this.data])){this._htmlmap=null;var i=this._buildGraph(n);i.clean();var o=this._layoutGraph(i,n);this._showGraph(o[0],o[1],n);var r=o[0].getNodes().length?o[0].getBox():[[0,0],[0,0]];this._set_dataobj_size(r),this.callEvent("onAfterRender",[])}},_getItemSize:function(t){var e=this.getShape(t.type||this.type.type)||{},n={width:t.width||e.width||this.type.width,height:t.height||e.height||this.type.height};n.width==n.height&&"auto"==n.width&&(webix.isUndefined(e.height)||"auto"==e.height?"auto"!=this.type.height?t.height=n.height=this.type.height:t.height=n.height=this.type.__proto__.height:t.height=n.height=e.height);var i="auto"==n.width?"width":"auto"==n.height?"height":null;if(i){var o=webix.html.create("DIV",{"class":"webix_view webix_diagram_measure_size "+this.type.classname.call(this,t,this.type),style:"visibility:hidden;position:absolute;top:0px;left:0px;width:".concat(n.width,"px;height:").concat(n.height,"px")});o.style[i]="auto",document.body.appendChild(o);var r=this.type.template.call(this,t,this.type);o.innerHTML=r?this.type.templateTextStart.call(this,t,this.type)+r+this.type.templateTextEnd.call(this,t,this.type):this.type.templateSvg.call(this,t,this.type),t[i]=n[i]=o["width"==i?"offsetWidth":"offsetHeight"]+1,webix.html.remove(o)}return n},_buildGraph:function(i){var o=this,r=new a.Graph,s=0;return this.data.each(function(t){var e=o._getItemSize(t),n={id:t.id,w:e.width,h:e.height};s=Math.max(s,e.width,e.height),i.preserveLocation&&webix.extend(n,{x:1*t.x+n.w/2,y:1*t.y+n.h/2}),r.addNode(n),delete t.$list}),i.levelPadding=s+(this.type.marginY||this.type.margin),this._links.data.each(function(t){r.hash[t.source]&&r.hash[t.target]&&r.addEdge(t.source,t.target)}),r},_layoutGraph:function(t,e){var n,i=this;if(e.preserveLocation)(n=t).setGlobalBox();else{var o=new a.Hola(e);n=a.compose(a.decompose(t).map(function(t){return t=o.layout(t,e),e.full||t.setGlobalBox(),t}),{padding:this.config.treePadding})}if(!n)return[t,[]];if(!e.preserveLocation){var r=n.getBox();n.translate({x:-r[0][0],y:-r[1][0]})}var s=new a.Router({mode:1==this._line_modes[this.linkType.mode]?1:2,
    padding:this.type.listMarginX/2});return n.nodes.forEach(function(t){return s.addShape(t.id,t.x-t.w/2,t.y-t.h/2,t.x+t.w/2,t.y+t.h/2)}),this._links.data.each(function(t){n.hash[t.source]&&n.hash[t.target]&&(s.addConnector(t.id,t.source,t.target,i._line_modes[t.mode]),4==i._line_modes[t.mode]?(i.data.getItem(t.source).$list=!0,i.data.getItem(t.target).$list=!0):3==i._line_modes[t.mode]&&(i.data.getItem(t.target).$list=!0))}),[n,s.finalize(a.Direction.Bottom)]},_showGraph:function(n,t,i){var d=this,u="";this.data.each(function(t){if(!i.preserveLocation){var e=n.getNode(t.id);t.x=e.x-e.w/2,t.y=e.y-e.h/2}u+=d._toHTMLItem(t)}),this._shapes_layer.innerHTML=u,u="",t.forEach(function(t){var e=d._links.getItem(t.id);u+=d.linkType.templateLink.call(d,e,d.linkType,t.line)}),t.forEach(function(t){var e=d._links.getItem(t.id);if(webix.isUndefined(e.arrow)?d.linkType.arrow:e.arrow){var n={correction:1,width:0,height:0,mode:null},i=t.line;webix.isArray(e.line)&&1<e.line.length&&(n.correction=0,i=e.line.map(function(t){return webix.isArray(t)?t:t.split(",").map(function(t){return 1*t})}));var o=i.length,r=i[--o],s=i[--o];if(n.correction){var a=d.getItem(e.target),h=d.getShape(a.type||d.type.type)||{},l=a.$list?d.type.listMarginX:0;for(n.width=a.width||h.width||d.type.width-l,n.height=a.height||h.height||d.type.height;s&&!d._check_point(s,a,n);)r=s,s=i[--o]}n.x=r[0],n.y=r[1],s?s[0]==r[0]?(n.mode="height",n.k=s[1]<r[1]?-1:1):s[1]==r[1]&&(n.mode="width",n.k=s[0]<r[0]?-1:1):n.mode=null,u+=d.linkType.templateArrow.call(d,e,d.linkType,n.mode&&d._get_arrow(e,n))}}),this._links_layer.innerHTML=u},_check_point:function(t,e,n){return t[0]<e.x||t[0]>e.x+n.width||t[1]<e.y||t[1]>e.y+n.height},_get_arrow:function(t,e){var n=t.arrowSize||this.linkType.arrowSize,i=Math.ceil(n/Math.sqrt(3));return"height"==e.mode?(e.y+=e.correction*e.k*e[e.mode]/2,[[e.x-i,e.y+e.k*n],[e.x,e.y],[e.x+i,e.y+e.k*n]]):(e.x+=e.correction*e.k*e[e.mode]/2,[[e.x+e.k*n,e.y-i],[e.x,e.y],[e.x+e.k*n,e.y+i]])},_initShapes:function(t){var n=this;this._shapes=new webix.DataCollection,this._destroy_with_me.push(this._shapes);var e=[];for(var i in o)e.push({id:i,name:i,svg:o[i]});this._shapes.parse(e),webix.isArray(t)&&t.forEach(function(t){var e=t.id||t.name;e&&(n.getShape(e)?n.setShape(e,t):n.addShape(e,t))})},addShape:function(t,e){return this.getShape(t)?null:(e.id=t,e.name=t,this._shapes.add(e))},getShape:function(t){return this._shapes.getItem(t)},setShape:function(t,e){this.getShape(t)&&this._shapes.updateItem(t,e)},_setScheme:function(t){return t||(t={}),t.$serialize=t.$serialize||this._exportScheme,t.$export=t.$export||this._exportScheme,t}},webix.AutoTooltip,webix.DataMarks,webix.SelectionModel,webix.MouseEvents,webix.Scrollable,webix.DataLoader,webix.ui.baseview,webix.EventSystem)});
    //# sourceMappingURL=diagram.js.map